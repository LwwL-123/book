# 门限签名

门限签名（Threshold Signature Scheme，TSS）是数字签名的一个重要分支，它是一种基于安全多方计算（Secure Multi-Party Computation，MPC）的密码学技术，也是 MPC 密钥管理的重要研究方向。

1. 没有任何人知道完整的私钥，也即私钥永远不会出现。
2. 所有参与者共同计算出完整私钥所对应的公钥。
3. 需要m个参与者(m≤n)即可产生对应完整私钥的签名。

![img](https://picture-1258612855.cos.ap-shanghai.myqcloud.com/202304121011061)

## 1. 门限密钥生成

先设想一下如何分布式地保存私钥。私钥本质上是自然数，假设我的私钥是50，我可以拆分成10+25+15三个私钥片段分别给三个不同的人保管。上述方案对TSS而言有三个问题：

- 三个人必须同时出现，少一方都无法恢复这个私钥，有严重的单点故障，不符合门限的需求。
- 『我』是一个中心化的实体，不符合dealerless的要求。
- 完整的私钥在分发和重构时出现了两次。不符合完整的私钥永不出现这一性质。

所以，如果要实现一个2-of-3（三人持私钥片段，任意两人即可签名）的门限密钥生成方案，先让三人`Pᵢ (i∈[1,3])`每个人各自生成自己的私钥片段`uᵢ`并秘密地保存起来。由于门限要求，那么这三人所持有的私钥片段之间必须有**间接的数学联系**，以在缺少一方的情况下也有恢复完整私钥的能力。

注意，这里所说的具有**『恢复完整私钥的能力』只是一种『能力』**，并非要实施『恢复完整私钥』这个行为。该能力实际上等价于『可用签名碎片拼出对应完整私钥的签名的能力』，后者对应的行为才是我们最终要实施的。所以在下文中提到『恢复完整的私钥』时，仅仅指的是这种能力，或者在思维实验中实施该行为，而非要在现实的TSS方案中进行。



## 2. SSS与『间接的数学联系』

假设私钥碎片为`u₁=20, u₂=40, u₃=80`。如果允许中心化的dealer和完整的私钥出现，那每个人把私钥`uᵢ`发给dealer，他就可以计算出完整私钥`u=140`后用**Shamir秘密共享**（SSS）方案：把完整私钥拆碎后再分配，在拆分和合成过程中这些私钥碎片之间会用**拉格朗日多项式**产生间接的数学联系。

### 2.1 SSS的秘密分发

现有门限参数m-of-n，dealer对秘密`u`进行SSS：

1. 先构造最高次为`t = m - 1`的**主多项式**`F(x)`

![img](https://picture-1258612855.cos.ap-shanghai.myqcloud.com/202304121016681)