# Go 语言中 Set 的最佳实现方案

## Set 语义与实现方案

Set 集合是其他语言中常见的数据结构。特性：集合中的对象不按特定的方式排序，并且没有重复对象。

![image-20220105175906258](https://picture-1258612855.cos.ap-shanghai.myqcloud.com/20220325171008.png)

学习 Go ，要记住：Go 没有包含的东西，不代表 Go 真的没有。根据 Set 特性，我们可以很轻松地想到使用 map 的实现方案（因为 map 的 key 是不重复的）：把对象当做 key 存入 map。

使用 map 来实现 Set，意味着我们只关心 key 的存在，其 value 值并不重要。有其他语言编程经验的人也许会选择 `bool` 来作为 value，因为它是其它语言中内存消耗最少的类型（1个字节）。但是在 Go 中，还有另一种选择：`struct{}`



从内存开销而言，`struct{}` 是最小的，反映在执行时间上也是最少的。由于 `bool` 类型仅占一个字节，它相较于空结构而言，相差的并不多。但是，如果使用 interface{} 类型，那差距就很明显了。

所以，毫无疑问，在 Set 的实现中， map 值类型应该选 struct{}。



空结构体除了是实现 Set 的 value 值最佳方案，它还可以应用于以下方面：

- 通知信号的 channel：当 channel 只用于通知 goroutine 的执行事件，此时 channel 就不需要发送任何实质性的数据，选择使用 `chan struct{}` 。
- 没有状态数据的结构体：当对象只拥有方法，而不包含任何的属性字段时，选择使用空结构体定义该对象。